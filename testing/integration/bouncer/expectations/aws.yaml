- id: aws-describe-policy1
  httpRequest:
    method: POST
    body:
      FirewallPolicyName: test-policy
  httpResponse:
    statusCode: 200
    body:
      FirewallPolicy:
        StatelessDefaultActions:
          - aws:forward_to_sfe
        StatelessFragmentDefaultActions:
          - aws:forward_to_sfe
        StatelessRuleGroupReferences:
          - Priority: 1
            ResourceArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-unaudited-cube
      FirewallPolicyResponse: &FirewallPolicyResponse
        Description: null
        FirewallPolicyArn: arn:aws:network-firewall:us-east-1:364291808490:firewall-policy~test-policy
        FirewallPolicyId: dummy-id
        FirewallPolicyName: test-policy
        FirewallPolicyStatus: ACTIVE
      UpdateToken: dummy-update-token
  times:
    remainingTimes: 4
    unlimited: false
- id: aws-DescribeRuleGroup1
  httpRequest:
    method: POST
    body:
      RuleGroupArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-unaudited-cube
  httpResponse: &RuleGroupOneSourceResponse
    statusCode: 200
    body:
      RuleGroup:
        RulesSource:
          StatelessRulesAndCustomActions:
            StatelessRules:
              - Priority: 1
                RuleDefinition:
                  Actions:
                    - aws:drop
                  MatchAttributes:
                    Sources:
                      - AddressDefinition: 1.2.3.4/32
      RuleGroupResponse: &RuleGroupResponse
        Capacity: 1000
        Description: Blocklist generated by CrowdSec Cloud Firewall Bouncer
        RuleGroupArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-unaudited-cube
        RuleGroupName: crowdsec-unaudited-cube
        RuleGroupStatus: ACTIVE
        Type: STATELESS
      UpdateToken: dummy-update-token
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-DescribeRuleGroup2
  httpRequest:
    method: POST
    body:
      RuleGroupName: crowdsec-unaudited-cube
      Type: STATELESS
  httpResponse: *RuleGroupOneSourceResponse
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-UpdateRuleGroup1
  httpRequest:
    method: POST
    body:
      RuleGroup:
        RulesSource:
          StatelessRulesAndCustomActions:
            StatelessRules:
              - Priority: 1
                RuleDefinition:
                  Actions:
                    - aws:drop
                  MatchAttributes:
                    Sources:
                      - AddressDefinition: 1.2.3.4/32
                      - AddressDefinition: 1.2.3.5/32
      RuleGroupName: crowdsec-unaudited-cube
      Type: STATELESS
      UpdateToken: dummy-update-token
  httpResponse:
    statusCode: 200
    body:
      RuleGroupResponse: {}
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-DescribeRuleGroup3
  httpRequest:
    method: POST
    body:
      RuleGroupArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-unaudited-cube
  httpResponse: &RuleGroupTwoSourceResponse
    statusCode: 200
    body:
      RuleGroup:
        RulesSource:
          StatelessRulesAndCustomActions:
            StatelessRules:
              - Priority: 1
                RuleDefinition:
                  Actions:
                    - aws:drop
                  MatchAttributes:
                    Sources:
                      - AddressDefinition: 1.2.3.4/32
                      - AddressDefinition: 1.2.3.5/32
      RuleGroupResponse: *RuleGroupResponse
      UpdateToken: dummy-update-token
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-DescribeRuleGroup4
  httpRequest:
    method: POST
    body:
      RuleGroupName: crowdsec-unaudited-cube
      Type: STATELESS
  httpResponse: *RuleGroupTwoSourceResponse
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-UpdateRuleGroup2
  httpRequest:
    method: POST
    body:
      RuleGroup:
        RulesSource:
          StatelessRulesAndCustomActions:
            StatelessRules:
              - Priority: 1
                RuleDefinition:
                  Actions:
                    - aws:drop
                  MatchAttributes:
                    Sources:
                      - AddressDefinition: 1.2.3.4/32
                      - AddressDefinition: 1.2.3.5/32
                      - AddressDefinition: 1.2.3.9/32
      RuleGroupName: crowdsec-unaudited-cube
      Type: STATELESS
      UpdateToken: dummy-update-token
  httpResponse:
    statusCode: 200
    body:
      RuleGroupResponse: {}
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-DescribeRuleGroup5
  httpRequest:
    method: POST
    body:
      RuleGroupArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-unaudited-cube
  httpResponse: &RuleGroupThreeSourceResponse
    statusCode: 200
    body:
      RuleGroup:
        RulesSource:
          StatelessRulesAndCustomActions:
            StatelessRules:
              - Priority: 1
                RuleDefinition:
                  Actions:
                    - aws:drop
                  MatchAttributes:
                    Sources:
                      - AddressDefinition: 1.2.3.4/32
                      - AddressDefinition: 1.2.3.5/32
                      - AddressDefinition: 1.2.3.9/32
      RuleGroupResponse: *RuleGroupResponse
      UpdateToken: dummy-update-token
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-DescribeRuleGroup6
  httpRequest:
    method: POST
    body:
      RuleGroupName: crowdsec-unaudited-cube
      Type: STATELESS
  httpResponse: *RuleGroupThreeSourceResponse
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-UpdateFirewallPolicy1
  httpRequest:
    method: POST
    body:
      FirewallPolicy:
        StatelessDefaultActions:
          - aws:forward_to_sfe
        StatelessFragmentDefaultActions:
          - aws:forward_to_sfe
        StatelessRuleGroupReferences: []
      FirewallPolicyArn: arn:aws:network-firewall:us-east-1:364291808490:firewall-policy~test-policy
      UpdateToken: dummy-update-token
  httpResponse:
    statusCode: 200
    body:
      RuleGroupResponse: {}
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-DeleteRuleGroup
  httpRequest:
    method: POST
    headers:
      X-Amz-Target: [".*DeleteRuleGroup"]
    body:
      RuleGroupArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-unaudited-cube
  httpResponse:
    statusCode: 200
    body: {}
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-describe-policy2
  httpRequest:
    method: POST
    body:
      FirewallPolicyName: test-policy
  httpResponse:
    statusCode: 200
    body:
      FirewallPolicy:
        StatelessDefaultActions:
          - aws:forward_to_sfe
        StatelessFragmentDefaultActions:
          - aws:forward_to_sfe
        StatelessRuleGroupReferences: []
      FirewallPolicyResponse: *FirewallPolicyResponse
      UpdateToken: dummy-update-token
  times:
    remainingTimes: 2
    unlimited: false
- id: aws-CreateRuleGroup
  httpRequest:
    method: POST
    headers:
      X-Amz-Target: [".*CreateRuleGroup"]
    body:
      Capacity: 1000
      Description: Blocklist generated by CrowdSec Cloud Firewall Bouncer
      RuleGroup:
        RulesSource:
          StatelessRulesAndCustomActions:
            StatelessRules:
              - Priority: 1
                RuleDefinition:
                  Actions:
                    - aws:drop
                  MatchAttributes:
                    Sources:
                      - AddressDefinition: 1.2.3.9/32
      Type: STATELESS
  httpResponse:
    statusCode: 200
    body:
      RuleGroupResponse:
        RuleGroupArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-weird-bunny
  times:
    remainingTimes: 1
    unlimited: false
- id: aws-AddRuleToFirewallPolicy
  httpRequest:
    method: POST
    body:
      FirewallPolicyArn: arn:aws:network-firewall:us-east-1:364291808490:firewall-policy~test-policy
      FirewallPolicy:
        StatelessDefaultActions:
          - aws:forward_to_sfe
        StatelessFragmentDefaultActions:
          - aws:forward_to_sfe
        StatelessRuleGroupReferences:
          - Priority: 1
            ResourceArn: arn:aws:network-firewall:us-east-1:364291808490:stateless-rulegroup~crowdsec-weird-bunny
      UpdateToken: dummy-update-token
  httpResponse:
    statusCode: 200
    body:
      RuleGroupResponse: {}
  times:
    remainingTimes: 1
    unlimited: false
