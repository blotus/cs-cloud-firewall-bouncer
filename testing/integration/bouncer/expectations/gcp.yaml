- id: google-token
  httpRequest:
    method: POST
    path: /
    body: code=dummy&grant_type=authorization_code
  httpResponse:
    statusCode: 200
    body:
      access_token: MTQ0NjJkZmQ5OTM2NDE1ZTZjNGZmZjI3
      token_type: bearer
      expires_in: 3600
      refresh_token: IwOGYzYTlmM2YxOTQ5MGE3YmNmMDFkNTVk
- id: gcp-list-rules1
  httpRequest:
    method: GET
    path: /projects/crowdsec-dummy-project/global/firewalls
    queryStringParameters:
      alt:
        - json
      filter:
        - name=crowdsec*
      prettyPrint:
        - "false"
  httpResponse:
    statusCode: 200
    body:
      items:
        - name: crowdsec-denim-mushiness
          sourceRanges:
            - 1.2.3.4/32
          priority: 0
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-patch-rule1
  httpRequest:
    method: PATCH
    path: /projects/crowdsec-dummy-project/global/firewalls/crowdsec-denim-mushiness
    queryStringParameters:
      alt:
        - json
      prettyPrint:
        - "false"
    body:
      sourceRanges:
        - 1.2.3.4/32
        - 1.2.3.5/32
  httpResponse:
    statusCode: 200
    body:
      id: "12345"
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-list-rules2
  httpRequest:
    method: GET
    path: /projects/crowdsec-dummy-project/global/firewalls
    queryStringParameters:
      alt:
        - json
      filter:
        - name=crowdsec*
      prettyPrint:
        - "false"
  httpResponse:
    statusCode: 200
    body:
      items:
        - name: crowdsec-denim-mushiness
          sourceRanges:
            - 1.2.3.4/32
            - 1.2.3.5/32
          priority: 0
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-patch-rule2
  httpRequest:
    method: PATCH
    path: /projects/crowdsec-dummy-project/global/firewalls/crowdsec-denim-mushiness
    queryStringParameters:
      alt:
        - json
      prettyPrint:
        - "false"
    body:
      sourceRanges:
        - 1.2.3.4/32
        - 1.2.3.5/32
        - 1.2.3.9/32
  httpResponse:
    statusCode: 200
    body:
      id: "12345"
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-list-rules3
  httpRequest:
    method: GET
    path: /projects/crowdsec-dummy-project/global/firewalls
    queryStringParameters:
      alt:
        - json
      filter:
        - name=crowdsec*
      prettyPrint:
        - "false"
  httpResponse:
    statusCode: 200
    body:
      items:
        - name: crowdsec-denim-mushiness
          sourceRanges:
            - 1.2.3.4/32
            - 1.2.3.5/32
            - 1.2.3.9/32
          priority: 0
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-delete-rule
  httpRequest:
    method: DELETE
    path: /projects/crowdsec-dummy-project/global/firewalls/crowdsec-denim-mushiness
    queryStringParameters:
      alt:
        - json
      prettyPrint:
        - "false"
  httpResponse:
    statusCode: 200
    body:
      id: "12345"
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-list-rules-empty
  httpRequest:
    method: GET
    path: /projects/crowdsec-dummy-project/global/firewalls
    queryStringParameters:
      alt:
        - json
      filter:
        - name=crowdsec*
      prettyPrint:
        - "false"
  httpResponse:
    statusCode: 200
    body:
      items: []
  times:
    remainingTimes: 1
    unlimited: false
- id: gcp-insert-rule
  httpRequest:
    method: POST
    path: /projects/crowdsec-dummy-project/global/firewalls
    queryStringParameters:
      alt:
        - json
      prettyPrint:
        - "false"
    body:
      denied:
        - IPProtocol: all
      description: Blocklist generated by CrowdSec Cloud Firewall Bouncer
      direction: INGRESS
      network: global/networks/default
      sourceRanges:
        - 1.2.3.9/32
      priority: 100
  httpResponse:
    statusCode: 200
    body:
      id: "12345"
  times:
    remainingTimes: 1
    unlimited: false
