[
  {
    "id": "mockserver-healtz",
    "httpRequest": {
      "method": "GET",
      "path": "/healthz"
    },
    "httpResponse": {
      "statusCode": 200
    },
    "times": {
      "unlimited": true
    }
  },
  {
    "id": "lapi-startup-stream",
    "httpRequest": {
      "method": "GET",
      "path": "/v1/decisions/stream",
      "queryStringParameters": {
        "startup": ["true"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "deleted": [
          {
            "value": "1.2.3.6"
          },
          {
            "value": "1.2.3.7"
          }
        ],
        "new": [
          {
            "value": "1.2.3.4"
          },
          {
            "value": "1.2.3.5"
          }
        ]
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "lapi-stream-add",
    "httpRequest": {
      "method": "GET",
      "path": "/v1/decisions/stream",
      "queryStringParameters": {
        "startup": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "deleted": null,
        "new": [
          {
            "value": "1.2.3.9"
          }
        ]
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "lapi-stream-empty",
    "httpRequest": {
      "method": "GET",
      "path": "/v1/decisions/stream",
      "queryStringParameters": {
        "startup": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "deleted": null,
        "new": null
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "lapi-stream-delete-all",
    "httpRequest": {
      "method": "GET",
      "path": "/v1/decisions/stream",
      "queryStringParameters": {
        "startup": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "deleted": [
          {
            "value": "1.2.3.4"
          },
          {
            "value": "1.2.3.5"
          },
          {
            "value": "1.2.3.9"
          }
        ],
        "new": null
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "lapi-stream-add2",
    "httpRequest": {
      "method": "GET",
      "path": "/v1/decisions/stream",
      "queryStringParameters": {
        "startup": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "deleted": null,
        "new": [
          {
            "value": "1.2.3.9"
          }
        ]
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "lapi-stream-empty-forever",
    "httpRequest": {
      "method": "GET",
      "path": "/v1/decisions/stream",
      "queryStringParameters": {
        "startup": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "deleted": null,
        "new": null
      }
    },
    "times": {
      "unlimited": true
    }
  },
  {
    "id": "google-token",
    "httpRequest": {
      "method": "POST",
      "path": "/",
      "body": "code=dummy&grant_type=authorization_code"
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "access_token": "MTQ0NjJkZmQ5OTM2NDE1ZTZjNGZmZjI3",
        "token_type": "bearer",
        "expires_in": 3600,
        "refresh_token": "IwOGYzYTlmM2YxOTQ5MGE3YmNmMDFkNTVk"
      }
    }
  },
  {
    "id": "gcp-list-rules1",
    "httpRequest": {
      "method": "GET",
      "path": "/projects/crowdsec-dummy-project/global/firewalls",
      "queryStringParameters": {
        "alt": ["json"],
        "filter": ["name=crowdsec*"],
        "prettyPrint": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "items": [
          {
            "name": "crowdsec-denim-mushiness",
            "sourceRanges": ["1.2.3.4/32"]
          }
        ]
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-patch-rule1",
    "httpRequest": {
      "method": "PATCH",
      "path": "/projects/crowdsec-dummy-project/global/firewalls/crowdsec-denim-mushiness",
      "queryStringParameters": {
        "alt": ["json"],
        "prettyPrint": ["false"]
      },
      "body": {
        "sourceRanges": ["1.2.3.4/32", "1.2.3.5/32"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "id": "12345"
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-list-rules2",
    "httpRequest": {
      "method": "GET",
      "path": "/projects/crowdsec-dummy-project/global/firewalls",
      "queryStringParameters": {
        "alt": ["json"],
        "filter": ["name=crowdsec*"],
        "prettyPrint": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "items": [
          {
            "name": "crowdsec-denim-mushiness",
            "sourceRanges": ["1.2.3.4/32", "1.2.3.5/32"]
          }
        ]
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-patch-rule2",
    "httpRequest": {
      "method": "PATCH",
      "path": "/projects/crowdsec-dummy-project/global/firewalls/crowdsec-denim-mushiness",
      "queryStringParameters": {
        "alt": ["json"],
        "prettyPrint": ["false"]
      },
      "body": {
        "sourceRanges": ["1.2.3.4/32", "1.2.3.5/32", "1.2.3.9/32"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "id": "12345"
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-list-rules3",
    "httpRequest": {
      "method": "GET",
      "path": "/projects/crowdsec-dummy-project/global/firewalls",
      "queryStringParameters": {
        "alt": ["json"],
        "filter": ["name=crowdsec*"],
        "prettyPrint": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "items": [
          {
            "name": "crowdsec-denim-mushiness",
            "sourceRanges": ["1.2.3.4/32", "1.2.3.5/32", "1.2.3.9/32"]
          }
        ]
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-delete-rule",
    "httpRequest": {
      "method": "DELETE",
      "path": "/projects/crowdsec-dummy-project/global/firewalls/crowdsec-denim-mushiness",
      "queryStringParameters": {
        "alt": ["json"],
        "prettyPrint": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "id": "12345"
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-list-rules-empty",
    "httpRequest": {
      "method": "GET",
      "path": "/projects/crowdsec-dummy-project/global/firewalls",
      "queryStringParameters": {
        "alt": ["json"],
        "filter": ["name=crowdsec*"],
        "prettyPrint": ["false"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "items": []
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  },
  {
    "id": "gcp-insert-rule",
    "httpRequest": {
      "method": "POST",
      "path": "/projects/crowdsec-dummy-project/global/firewalls",
      "queryStringParameters": {
        "alt": ["json"],
        "prettyPrint": ["false"]
      },
      "body": {
        "denied": [
          {
            "IPProtocol": "all"
          }
        ],
        "description": "Blocklist generated by CrowdSec Cloud Firewall Bouncer",
        "direction": "INGRESS",
        "network": "global/networks/default",
        "sourceRanges": ["1.2.3.9/32"]
      }
    },
    "httpResponse": {
      "statusCode": 200,
      "body": {
        "id": "12345"
      }
    },
    "times": {
      "remainingTimes": 1,
      "unlimited": false
    }
  }
]
